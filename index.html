<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PDF Tools Generator</title>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; padding:20px; }
    .container { max-width:700px; margin:auto; background:#fff; padding:20px; border-radius:8px; }
    label { display:block; margin-top:12px; font-weight:bold; }
    input { width:100%; padding:8px; margin-top:6px; }
    button { margin-top:20px; padding:12px 20px; font-size:16px; cursor:pointer; }
  </style>
</head>
<body>
  <div class="container">
    <h2>PDF Generator (5 Pages)</h2>

    <label>PDF File Name (without .pdf)</label>
    <input id="pdfName" placeholder="my-ebook" />

    <label>Title</label>
    <input id="title" placeholder="Ebook Title" />

    <label>Author</label>
    <input id="author" placeholder="Author Name" />

    <label>Download Link</label>
    <input id="link" placeholder="https://example.com/download" />

    <label>Cover Image URL (Page 1 Full Image)</label>
    <input id="imageUrl" placeholder="https://example.com/cover.jpg" />

    <button onclick="generatePDF()">Generate PDF</button>
  </div>

  <script>
    /* ================= BASE64 DOWNLOAD BUTTON ================= */
    const DOWNLOAD_BUTTON_BASE64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAABkCAYAAABn8Y2NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB9UlEQVR4nO3cMW7UQBiG4S9jQZkY2YpZQbYJ2yT2oJ1gk7Jm2bZQz0QF7B5l6l8y5Z0wH7e+N8y+ZkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwK9P7q+f3wHn5Z1z+fV6fM5+4w4wzYcJ8mZ5m7m3p9c6x9z2Zz7t9Vv7b3p0k+vH5n9r3n3Y+u3YcK8uJfZ7cPz+3z+M4b+9v7+f8+Nf1r8j8Zx2Z2Y7m5+7X5Yv7z9+2YfL8+f+7+Pz9Pp9u8b5Z7s3b+M8Pz9+v9/8P7v9v8f7f9Pz9Pp9u8b5Z7s3b+M8Pz9+v9/8P7v9v8f7f9Pz9Pp9u8b5Z7s3b+M8Pz9+v9/8P7v9v8f7f9Pz9Pp9u8b5Z7s3b+M8Pz9+v9/8P7v9v8f7f9Pz9Pp9u8b5Z7s3b+M8Pz9+v9/8P7v9v8f7f9Pz9Pp9u8b5Z7s3b+M8Pz9+v9/8P7v9v8f7f9Pz9Pp9u8b5Z7s3b+M8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwZ/4B0k2p5b0l2GkAAAAASUVORK5CYII=';

    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: 'portrait', unit: 'pt', format: 'a4' });

      const pdfName = document.getElementById('pdfName').value || 'ebook';
      const TITLE = document.getElementById('title').value || 'TITLE';
      const AUTHOR = document.getElementById('author').value || 'AUTHOR';
      const LINK = document.getElementById('link').value || 'https://example.com';
      const imageUrl = document.getElementById('imageUrl').value;

      const pageWidth = doc.internal.pageSize.getWidth();
      const pageHeight = doc.internal.pageSize.getHeight();

      // ALWAYS wait for cover image before continuing
      if (imageUrl) {
        loadImage(imageUrl).then(img => {
          doc.addImage(img, 'PNG', 0, 0, pageWidth, pageHeight);
          buildRemainingPages(doc, pageWidth, pageHeight, TITLE, AUTHOR, LINK, pdfName);
        }).catch(() => {
          buildRemainingPages(doc, pageWidth, pageHeight, TITLE, AUTHOR, LINK, pdfName);
        });
      } else {
        buildRemainingPages(doc, pageWidth, pageHeight, TITLE, AUTHOR, LINK, pdfName);
      }
    }

    function buildRemainingPages(doc, pageWidth, pageHeight, TITLE, AUTHOR, LINK, pdfName) {
      /* -------- Page 2 -------- */
      doc.addPage();

      doc.setFont('Helvetica', 'bold');
      doc.setFontSize(22);
      doc.text(`Download or Read Online ${TITLE} free ebook (PDF ePub Mobi) - ${AUTHOR}`, 40, 80, { maxWidth: pageWidth - 80 });

      doc.setFont('Helvetica', 'normal');
      doc.setFontSize(18);
      doc.text(`Ebook PDF ${TITLE} | EBOOK ONLINE DOWNLOAD`, 40, 140);

      doc.setFontSize(16);
      const paragraph = `If you want to download a free ebook, you're in the right place. Ebook/PDF ${TITLE} DOWNLOAD in English is available for free here. Click on the download LINK below to download the Ebook ${TITLE} PDF Download in English by ${AUTHOR} (Author).`;
      doc.text(paragraph, 40, 190, { maxWidth: pageWidth - 80 });

      const btnWidth = 260;
      const btnHeight = 90;
      const x = (pageWidth - btnWidth) / 2;
      const y = pageHeight - 200;

      doc.addImage(DOWNLOAD_BUTTON_BASE64, 'PNG', x, y, btnWidth, btnHeight);
      doc.link(x, y, btnWidth, btnHeight, { url: LINK });

      /* -------- Pages 3â€“5 -------- */
      doc.addPage();
      doc.addPage();
      doc.addPage();

      doc.save(`${pdfName}.pdf`);
    }

    function loadImage(url) {
      return new Promise((resolve, reject) => {
        const img = new Image();
        img.crossOrigin = 'Anonymous';
        img.onload = () => resolve(img);
        img.onerror = reject;
        img.src = url;
      });
    }
  </script>
</body>
</html>
